services:
  aika:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: aika-agent
    env_file:
      - .env
    restart: unless-stopped
    volumes:
      - ./data:/data
      - /var/run/docker.sock:/var/run/docker.sock
    command: ["python", "-m", "src.main"]

  sandbox-image:
    image: agent-sandbox-runner:latest
    build:
      context: .
      dockerfile: sandbox/Dockerfile
    command: ["bash", "-lc", "echo sandbox image built"]
    profiles:
      - build
